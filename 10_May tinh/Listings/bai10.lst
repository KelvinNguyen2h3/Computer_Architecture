C51 COMPILER V9.60.7.0   BAI10                                                             10/23/2023 11:01:35 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE BAI10
OBJECT MODULE PLACED IN .\Objects\bai10.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE bai10.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\bai
                    -10.lst) TABS(2) OBJECT(.\Objects\bai10.obj)

line level    source

   1          #include "reg52.h"
   2          
   3          typedef unsigned int     u16;
   4          typedef unsigned char    u8;
   5          
   6          #define KEY_MATRIX_PORT     P1
   7          #define SMG_SEG_PORT        P0
   8          
   9          u8 gsmg_code[16]={0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07,
  10                           0x7f,0x6f,0x3f,0x7c,0x39,0x46,0x40,0x48};
  11          
  12          u8 previous_key = 0;
  13          
  14          void delay_10us(u16 ten_us) {
  15   1        while(ten_us--);
  16   1      }
  17          
  18          u8 key_matrix_ranks_scan(void) {
  19   1        u8 key_value=0;
  20   1      
  21   1        KEY_MATRIX_PORT=0xf7;
  22   1        if(KEY_MATRIX_PORT!=0xf7) {
  23   2          delay_10us(1000);
  24   2          switch(KEY_MATRIX_PORT) {
  25   3            case 0x77: key_value=1;break;
  26   3            case 0xb7: key_value=4;break;
  27   3            case 0xd7: key_value=7;break;
  28   3            case 0xe7: key_value=10;break;
  29   3          }
  30   2        }
  31   1        while(KEY_MATRIX_PORT!=0xf7);
  32   1      
  33   1        KEY_MATRIX_PORT=0xfb;
  34   1        if(KEY_MATRIX_PORT!=0xfb) {
  35   2          delay_10us(1000);
  36   2          switch(KEY_MATRIX_PORT) {
  37   3            case 0x7b: key_value=2;break;
  38   3            case 0xbb: key_value=5;break;
  39   3            case 0xdb: key_value=8;break;
  40   3            case 0xeb: key_value=13;break;//+
  41   3          }
  42   2        }
  43   1        while(KEY_MATRIX_PORT!=0xfb);
  44   1      
  45   1        KEY_MATRIX_PORT=0xfd;
  46   1        if(KEY_MATRIX_PORT!=0xfd) {
  47   2          delay_10us(1000);
  48   2          switch(KEY_MATRIX_PORT) {
  49   3            case 0x7d: key_value=3;break;
  50   3            case 0xbd: key_value=6;break;
  51   3            case 0xdd: key_value=9;break;
  52   3            case 0xed: key_value=14;break;//-
  53   3          }
  54   2        }
C51 COMPILER V9.60.7.0   BAI10                                                             10/23/2023 11:01:35 PAGE 2   

  55   1        while(KEY_MATRIX_PORT!=0xfd);
  56   1      
  57   1        KEY_MATRIX_PORT=0xfe;
  58   1        if(KEY_MATRIX_PORT!=0xfe) {
  59   2          delay_10us(1000);
  60   2          switch(KEY_MATRIX_PORT) {
  61   3            //case 0x7e: key_value=4;break;
  62   3            //case 0xbe: key_value=7;break;
  63   3            //case 0xde: key_value=12;break;
  64   3            case 0xee: key_value=15;break;//=
  65   3          }
  66   2        }
  67   1        while(KEY_MATRIX_PORT!=0xfe);
  68   1      
  69   1        return key_value;
  70   1      }
  71          
  72          void display_result(u8 result) {
  73   1        SMG_SEG_PORT=gsmg_code[result];
  74   1      }
  75          
  76          int main() {
  77   1        u8 key = 0;
  78   1        u8 result = 0;
  79   1      
  80   1        while(1) {
  81   2          key = key_matrix_ranks_scan();
  82   2      
  83   2          if (key == 13) {
  84   3            result += previous_key;
  85   3          } else if (key == 14) {
  86   3            result -= previous_key;
  87   3          } else if (key == 15) {
  88   3            display_result(result);
  89   3          }
  90   2        }
  91   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    255    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     17       1
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
